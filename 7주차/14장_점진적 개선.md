# 14장. 점진적 개선

**목차**

1. 책의 예제
2. 점진적으로 개선하기
3. IDE로 점진적으로 개선하기

**정리**

# 책의 예제

![Untitled](https://user-images.githubusercontent.com/53958188/177472790-b2bc6604-4c21-4da5-afb5-0afa12658d5d.png)
<img width="100%" alt="Untitled 1" src="https://user-images.githubusercontent.com/53958188/177472798-810794f5-fbf0-4662-8014-0fe4c1fd83fb.png">


기존 코드의 문제점

- 모든 변수 선언과 메소드를 하나의 클래스 안에서 작성했다.
- 새로운 인수형을 추가하려고 하니, 타입만 다르고 동일한 개념의 메소드들이 중복되기 시작했다.

리팩터링하자!

1. 추상 개념으로 묶기
    - 인수를 추가할 때 HashMap, getter, setter 세 곳에 변경이 일어난다.
    - ArgumentMarshaler : 유사한 메서드를 제공하는 개념으로 묶었다.
    - 각 인수는 개념을 구현한 구현체로 만들었다.
    - setter에서 조건으로 인자 유형을 검사하던 부분을 하위 개념으로 내려 분리했다.
    - 이제 인수 유형을 추가하려면 개념에서 새 클래스를 파생해 getXX 함수를 추가하고 parseSchemaElement 함수에 새로운 case문만 추가하면 된다.
2. 테스트 코드 작성하기
    - 변경을 가한 후에도 시스템이 변경 전과 똑같이 돌아가는 것을 보장한다.
    - 코드를 변경해도 항상 테스트를 통과해야 한다.
3. 예외는 독자적인 모듈로 만들기
    - 로직과 예외 처리 코드를 분리하면 깨끗해져서 차후 확장이 쉬워진다.
    - 로직이 던지는 예외를 하나로 줄일 수 있다.

# 점진적으로 개선하기

<aside>
💡 프로그램을 망치는 가장 좋은 방법 중 하나는 개선이라는 이름 아래 구조를 크게 뒤집는 행위다.

</aside>

1. 코드 작성을 멈춘다
    
    코드가 나빠지고 있음을 느꼈을때 기능을 추가하지 않고 개선을 시작한다.
    

1. 테스트 코드를 작성한다
    
    변경을 가한 후에도 시스템이 변경 전과 똑같이 돌아가야한다. 테스트 코드가 없다면 작성하고, 코드를 수정하기 전 상태에서 모든 테스트가 통과해야한다.
    

1. 점진적으로 개선한다
    
    책임에 따라 클래스를 나누고, 코드를 옮긴다. 테스트가 깨지지 않
    도록 확인하며 자잘한 변경을 조금씩 진행한다.
    

# IDE로 점진적으로 개선하기

[인텔리제이 리팩토링 - Yun Blog | 기술 블로그](https://cheese10yun.github.io/intellij-refactoring/)

1. Extract Method
    - 코드 블럭을 메서드로 추출하기
    - 매번 복붙하지 않아도 된다
2. Change Signature
    - 메소드 파라미터 추가, 삭제 및 변경
3. Rename
    - 메서드나 변수 이름 변경
4. Extract Variable
    - 변수 추출
5. Extract Field
    - 특정 값을 멤버 변수로 설정할 수 있다
6. Extract Constant
    - 특정 값을 상수로 추출할 수 있다
7. Pull Members Up & Pull Members Down
    - 클래스의 메서드를 상위로 올리거나
    - 상위 클래스의 메서드를 하위로 내릴 수 있다
