# Chapter 12. 창발적 설계로 깔끔한 코드 구현하기

## 1. 창발적 설계
- 창발성: 하위 계층에는 없는 특성이나 행동이 상위 계층(전체 구조)에서 자발적으로 돌연히 출연하는 현상
- 창발적 설계: 단순한 4가지를 반복하다보면, 전체적으로 깨끗한 코드가 만들어진다.

   - 1. 모든 테스트를 실행한다.
        - 테스트를 작성할수록, 설계 품질이 좋아진다. 이 규칙을 따르면, 낮은 결합도와 높은 응집력이라는 목표를 저절로 달성할 수 있다.

   - 2. 중복을 없앤다.
        - 기존의 코드를 최대한 재활용한다. 각 메서드를 따로 구현하는 방법도 있지만, 중복을 없애기 위해 서로 분리하기도 한다.
        - template method 패턴: 알고리즘의 구조를 상위 클래스의 메서드에서 정의하고, 하위 클래스에서 자신에 맞게 세부 알고리즘을 정의한다.

   -.3. 프로그래머의 의도를 표현한다.
       - 좋은 이름을 선택한다. 다른사람을 위해 읽기 쉽게 만들려고 노력해야 한다.

   - 4. 실용적 관점에서 타협하기
       - 여러가지 규칙에 극단적으로 심취하여 클래스와 메서드를 무수하게 만들지 말라. 실용적인 관점에서 타협해야 한다.

# Chapter 13. 동시성
## 1. 동시성 프로그래밍
- 동시성 프로그램: 어플리케이션을 효율적으로 실행하기 위해 멀티 코어를 온전히 활용하도록 구현하는 방식이다.
- 외부 서비스의 응답을 기다리면서 아무일도 하지 않으면 CPU 사이클이 낭비되므로 낭비되는 자원을 줄여야 한다!

## 2. 동시성 프로그래밍이 필요한 이유
- 동시성은 항상 성능을 높여주는 것이 아니라, 때로 성능을 높여준다.
   ex) 웹 브라우저에서 여러가지 이미지 리소스를 불러오는 경우 (servlet)
- 동시성을 구현해도 설계를 바꿔야 한다.
- 컨테이너를 사용해도 동시성을 이해해야 한다. 어플리케이션이 컨테이너를 통해 멀티 스레드를 사용하기 때문에 컨테이너의 동작을 이해해야한다.
- 동시 수정, 데드락과 같은 문제를 피할 수 있는지를 알아야 한다.

## 3. 안전한 동시성 프로그래밍 원칙
- 단일 책임 원칙 (SRP): 동시성 코드는 다른 코드와 분리해야한다.
   - 동시성 코드는 독자적인 개발, 변경, 조율 주기가 있다.
- 공유 자료를 최대한 줄여야 한다. 동시 수정 문제를 피하기 위해 코드 내 임계영역을 synchronized 키워드로 보호해야 한다.
- 공유 자료를 줄이려면 최대한 공유하지 않는 방법이 제일 좋다.
- 다른 스레드와 자료를 공유하지 않도록 한다. thread는 가능한 독립적으로 구현하라!
- 동기화하는 메서드 사이에 존재하는 의존성을 이해해야 한다. 공유 객체 하나에는 메서드 하나만 사용하라!

## 4. 동시성 코드를 테스트해야 한다.
- 테스트를 했다고 동시성 코드가 100% 올바르다고 증명하기는 불가능하지만, 충분한 테스트는 위험을 낮춘다.
- 코드에 보조 코드를 넣어 돌려야한다. 드물게 발생하는 오류를 자주 발생시키도록 보조 코드를 추가한다.
